---
import { sanityClient } from "sanity:client";

export const prerender = true;
export async function getStaticPaths() {
  const TAGS_QUERY = `*[_type == "tag" && count(*[_type == "post" && references(^._id)]) > 0] {
    "slug": slug.current
  }`;
  
  const tags = await sanityClient.fetch(TAGS_QUERY);
  
  return tags.map(tag => ({
    params: { tag: tag.slug }
  }));
}

const { tag } = Astro.params;

// Redirect to page 1
return Astro.redirect(`/tags/${tag}/page1`);
---